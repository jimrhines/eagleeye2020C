jQuery(function(y){var b={isGroupedMixedProductType:function(){var a=y(".product-type-grouped"),o=0,e=0;return!!(a.length&&(a.find(".group_table tr.product").each(function(){0<y(this).find(".input-text.qty").val()&&(y(this).find(".entry-summary .subscription-details").length?o++:e++)}),0<o&&0<e))},escapeHtml:function(a){return document.createElement("div").appendChild(document.createTextNode(a)).parentNode.innerHTML},isGroupedSubsSelected:function(){var a=y(".product-type-grouped"),o=!1;return a.length&&a.find(".group_table tr.product").each(function(){if(0<y(this).find(".input-text.qty").val()&&y(this).find(".entry-summary .subscription-details").length)return!(o=!0)}),o},formatMoney:function(a){return accounting.formatMoney(a,{symbol:woocommerce_addons_params.currency_format_symbol,decimal:woocommerce_addons_params.currency_format_decimal_sep,thousand:woocommerce_addons_params.currency_format_thousand_sep,precision:woocommerce_addons_params.trim_trailing_zeros?0:woocommerce_addons_params.currency_format_num_decimals,format:woocommerce_addons_params.currency_format})},getCostByTax:function(a,o){return(!woocommerce_addons_params.price_include_tax||!woocommerce_addons_params.display_include_tax)&&(woocommerce_addons_params.price_include_tax&&!woocommerce_addons_params.display_include_tax||!woocommerce_addons_params.price_include_tax&&woocommerce_addons_params.display_include_tax||woocommerce_addons_params.price_include_tax||woocommerce_addons_params.display_include_tax)?o:a},init:function(a){var h=a,v=!!h.hasClass("variations_form")&&h.find('input[name="variation_id"], input.variation_id');h.on("click",".reset_variations",function(){y.each(h.find(".product-addon"),function(){var a=y(this).find(".addon");(a.is(":checkbox")||a.is(":radio"))&&a.prop("checked",!1),a.is("select")&&a.prop("selectedIndex",0),(a.is(":text")||a.is("textarea")||a.is('input[type="number"]')||a.is('input[type="file"]'))&&a.val("")}),h.trigger("woocommerce-product-addons-update")}).on("mouseup","input[type=number]",function(){y(this).trigger("woocommerce-product-addons-update")}).on("keyup change",".wc-pao-addon input, .wc-pao-addon textarea",function(){if(0<y(this).attr("maxlength")){var a=y(this).val(),o=y(this).attr("maxlength")-a.length;y(this).next(".wc-pao-addon-chars-remaining").find("span").text(o)}}).on("input change",".wc-pao-addon input, .wc-pao-addon textarea, .wc-pao-addon select, input.qty, .wc-pao-addon-custom-text, .wc-pao-addon-custom-price",function(){y(this).trigger("woocommerce-product-addons-update")}).on("found_variation",function(a,o){var e=y(this),t=e.find("#product-addons-total");if(void 0!==o.display_price)t.data("price",o.display_price);else if(y(o.price_html).find(".amount").last().length){var n=y(o.price_html).find(".amount").last().text();n=(n=(n=(n=n.replace(woocommerce_addons_params.currency_format_symbol,"")).replace(woocommerce_addons_params.currency_format_thousand_sep,"")).replace(woocommerce_addons_params.currency_format_decimal_sep,".")).replace(/[^0-9\.]/g,""),n=parseFloat(n),t.data("price",n)}e.trigger("woocommerce-product-addons-update")}).on("woocommerce-product-addons-update",function(){var w=0,g=0,n=h.find("#product-addons-total"),a=v&&0<v.length,o=h.find(".wcsatt-options-product"),e=0<o.length;if(product_id=a?v.val():n.data("product-id"),product_price=n.data("price"),product_type=n.data("type"),qty=parseFloat(h.find("input.qty").val()),addons=[],""===product_price&&"undefined"!=typeof custom_gift_card_amount&&custom_gift_card_amount.length&&0<custom_gift_card_amount.val()&&(product_price=custom_gift_card_amount.val()),woocommerce_addons_params.is_bookings&&y(".wc-bookings-booking-cost").length&&(product_price=parseFloat(y(".wc-bookings-booking-cost").attr("data-raw-price"))),h.find(".wc-pao-addon-field").each(function(){var a=y(this),o=a.parents(".wc-pao-addon"),e=o.find(".wc-pao-addon-name").length?o.find(".wc-pao-addon-name").data("addon-name"):"",t="",n=0,c=0,d=a.data("price-type"),i=!1,r={},s=!!o.find(".wc-pao-addon-name").length&&o.find(".wc-pao-addon-name").data("has-per-person-pricing"),p=!!o.find(".wc-pao-addon-name").length&&o.find(".wc-pao-addon-name").data("has-per-block-pricing");if(a.is(".wc-pao-addon-custom-price")){if(!a.val())return;i=!0,n=a.val(),c=a.val(),d="quantity_based"}else if(a.is(".wc-pao-addon-input-multiplier")){if(isNaN(a.val())||""===a.val()?(a.val(""),a.closest("p").find(".wc-pao-addon-alert").show()):(""!==a.val()&&a.val(Math.ceil(a.val())),a.closest("p").find(".wc-pao-addon-alert").hide()),!a.val())return;n=a.data("price")*a.val(),c=a.data("raw-price")*a.val()}else if(a.is(".wc-pao-addon-checkbox, .wc-pao-addon-radio")){if(!a.is(":checked"))return;t=a.data("label"),n=a.data("price"),c=a.data("raw-price")}else if(a.is(".wc-pao-addon-image-swatch-select, .wc-pao-addon-select")){if(!a.find("option:selected")||""===a.find("option:selected").val())return;d=a.find("option:selected").data("price-type"),a.val()&&(t=a.find("option:selected").data("label"),n=a.find("option:selected").data("price"),c=a.find("option:selected").data("raw-price"))}else{if(!a.val())return;n=a.data("price"),c=a.data("raw-price")}if(n=n||0,c=c||0,("booking"===product_type||"accommodation-booking"===product_type)&&woocommerce_addons_params.is_bookings){var l=qty=0;void 0!==y("#wc_bookings_field_duration")&&0<y("#wc_bookings_field_duration").val()&&(l=y("#wc_bookings_field_duration").val()),void 0!==y("#wc-bookings-form-end-time")&&0<y("#wc-bookings-form-end-time").val()&&(l=y("#wc-bookings-form-end-time").val());var u=y("#wc_bookings_field_persons"),_=0;1===u.length?_=parseInt(_,10)+parseInt(u.val(),10):y(".wc-bookings-booking-form").find("input").each(function(){var a=this.id.match(/wc_bookings_field_persons_(\d+)/);null!=a&&y("#"+a[0]).length&&(_=parseInt(_,10)+parseInt(y("#"+a[0]).val(),10))}),0===qty&&y(".wc-bookings-booking-cost").length&&(qty=1),s&&_&&(qty*=_),p&&l&&(qty*=l)}switch(d){case"flat_fee":r.cost=parseFloat(n),r.cost_raw=parseFloat(c);break;case"quantity_based":r.cost_pu=parseFloat(n),r.cost_raw_pu=parseFloat(c),r.cost=r.cost_pu*qty,r.cost_raw=r.cost_raw_pu*qty;break;case"percentage_based":r.cost_pct=parseFloat(n)/100,r.cost_raw_pct=parseFloat(c)/100,r.cost=parseFloat(product_price)*r.cost_pct*qty,r.cost_raw=parseFloat(product_price)*r.cost_raw_pct*qty}if(w+=r.cost||0,g+=r.cost_raw||0,void 0!==t){if("number"==typeof t||t.length)r.name=e+(t?" - "+t:"");else{var m=a.val(),f=parseInt(woocommerce_addons_params.trim_user_input_characters,10);a.is(".wc-pao-addon-file-upload")&&(m=m.replace(/^.*[\\\/]/,"")),f<m.length&&(m=m.slice(0,f)+"..."),r.name=e+" - "+b.escapeHtml(m)}r.is_custom_price=i,r.price_type=d,addons.push(r)}}),n.data("price_data",addons),qty){var t,c,d,i;b.formatMoney(w);if("undefined"!=typeof product_price&&product_id&&(t=y(".wc-bookings-booking-form").length?isNaN(product_price)?0:parseFloat(product_price):parseFloat(product_price*qty),c=b.formatMoney(t+w)),e){var r=h.data("satt_script");if(r&&r.schemes_model.get_active_scheme_key()){var s=o.find("input:checked");s.val()&&(d=s.parent().find(".subscription-details"))}}else h.parent().find(".subscription-details").length&&(h.hasClass("bundle_data")||(d=h.parent().find(".subscription-details"),v&&0<v.length&&(d=h.parent().find(".woocommerce-variation .subscription-details"))));if(d&&0<d.length&&(i=" "+d.clone().wrap("<p>").parent().html()),"grouped"===product_type?i&&!isGroupedMixedProductType()&&isGroupedSubsSelected()&&(c&&(c+=i)):i&&c&&(c+=i),c&&"1"==n.data("show-sub-total")){var p=h.find(".wc-pao-addon-container").data("product-name"),l=b.formatMoney(t);if(y(".wc-bookings-booking-form").length)var u='<div class="product-addon-totals"><ul><li><div class="wc-pao-col1"><strong>'+p+'</strong></div><div class="wc-pao-col2"><strong><span class="amount">'+l+"</span></strong></div></li>";else u='<div class="product-addon-totals"><ul><li><div class="wc-pao-col1"><strong><span>'+(x()?woocommerce_addons_params.quantity_symbol+qty:qty+woocommerce_addons_params.quantity_symbol)+"</span> "+p+'</strong></div><div class="wc-pao-col2"><strong><span class="amount">'+l+"</span></strong></div></li>";var _=!1;addons.length&&(y.each(addons,function(a,o){if("quantity_based"===o.price_type){var e=b.getCostByTax(o.cost_raw,o.cost),t=0===e?"-":b.formatMoney(e);u=u+'<li class="wc-pao-row-quantity-based"><div class="wc-pao-col1">'+o.name+'</div><div class="wc-pao-col2"><span class="amount">'+t+"</span></div></li>"}woocommerce_addons_params.tax_enabled&&o.is_custom_price&&(_=!0)}),y.each(addons,function(a,o){if("quantity_based"!==o.price_type){if("percentage_based"!==o.price_type)var e=b.getCostByTax(o.cost_raw,o.cost);else e=o.cost_raw;var t=0===e?"-":'<span class="amount">'+b.formatMoney(e)+"</span>";u=u+'<li><div class="wc-pao-col1"><strong>'+o.name+'</strong></div><div class="wc-pao-col2">'+t+"</div></li>"}}));var m="",f=void 0===n.data("i18n_sub_total")?woocommerce_addons_params.i18n_sub_total:n.data("i18n_sub_total");if(!(_||woocommerce_addons_params.price_display_suffix&&woocommerce_addons_params.tax_enabled))return u=u+'<li class="wc-pao-subtotal-line"><p class="price">'+f+' <span class="amount">'+c+"</span></p></li></ul></div>",n.html(u),void h.trigger("updated_addons");if(!_&&!1==-1<woocommerce_addons_params.price_display_suffix.indexOf("{price_including_tax}")&&!1==-1<woocommerce_addons_params.price_display_suffix.indexOf("{price_excluding_tax}"))return u=u+'<li class="wc-pao-subtotal-line"><strong>'+f+' <span class="amount">'+c+"</span> "+woocommerce_addons_params.price_display_suffix+"</strong></li></ul></div>",n.html(u),void h.trigger("updated_addons");y.ajax({type:"POST",url:woocommerce_addons_params.ajax_url,data:{action:"wc_product_addons_calculate_tax",product_id:product_id,add_on_total:w,add_on_total_raw:g,qty:qty},success:function(a){if("SUCCESS"==a.result){m='<small class="woocommerce-price-suffix">'+woocommerce_addons_params.price_display_suffix+"</small>";var o=b.formatMoney(a.price_including_tax),e=b.formatMoney(a.price_excluding_tax);m=(m=m.replace("{price_including_tax}",'<span class="amount">'+o+"</span>")).replace("{price_excluding_tax}",'<span class="amount">'+e+"</span>");var t=woocommerce_addons_params.display_include_tax?o:e;u=u+'<li class="wc-pao-subtotal-line"><p class="price">'+f+' <span class="amount">'+t+"</span> "+m+" </p></li></ul></div>",n.html(u),h.trigger("updated_addons")}else u=u+'<li class="wc-pao-subtotal-line"><p class="price">'+f+' <span class="amount">'+c+"</span></p></li></ul></div>",n.html(u),h.trigger("updated_addons")},error:function(){u=u+'<li class="wc-pao-subtotal-line"><p class="price">'+f+' <span class="amount">'+c+"</span></p></li></ul></div>",n.html(u),h.trigger("updated_addons")}})}else n.empty(),h.trigger("updated_addons")}else n.empty(),h.trigger("updated_addons")}).on("click touchend",".wc-pao-addon-image-swatch",function(a){a.preventDefault();var o=y(this).data("value"),e=y(this).parents(".wc-pao-addon-wrap"),t=y.parseHTML(y(this).data("price"));e.prevAll("label").find(".wc-pao-addon-image-swatch-price").remove(),e.find(".wc-pao-addon-image-swatch").removeClass("selected"),y(this).addClass("selected"),e.find(".wc-pao-addon-image-swatch-select").val(o),e.prevAll("label").append(y(t)),h.trigger("woocommerce-product-addons-update")}),h.find(" .wc-pao-addon-custom-text, .wc-pao-addon-custom-textarea").each(function(){0<y(this).attr("maxlength")&&y(this).after('<small class="wc-pao-addon-chars-remaining">'+woocommerce_addons_params.i18n_remaining+"</small>")}),y("#credit_called").on("keyup",function(){h.trigger("woocommerce-product-addons-update")}),h.find(".wc-pao-addon-custom, .wc-pao-addon-custom-textarea, .wc-pao-addon input, .wc-pao-addon textarea, .wc-pao-addon select, input.qty, .variations select").change();var o=h.get(0).querySelector('button[type="submit"]');o&&o.addEventListener("click",function(){var a=h.get(0).querySelector("*:invalid");a.focus(),a.scrollIntoView({block:"center",inline:"center"})}),y(".wc-pao-addon-image-swatch").tipTip({delay:200})}},x=function(){return"rtl"===document.documentElement.dir};y("body").on("quick-view-displayed",function(){y(this).find(".cart:not(.cart_group)").each(function(){b.init(y(this))})}),y("body .component").on("wc-composite-component-loaded",function(){y(this).find(".cart").each(function(){b.init(y(this))})}),y("body").find(".cart:not(.cart_group)").each(function(){b.init(y(this))}),y("body").find(".wc-pao-addon-checkbox-group-required").each(function(){var a=this;y(this).find(".wc-pao-addon-checkbox").change(function(){0<y(a).find("input:checked").length?(y(a).removeClass("wc-pao-addon-checkbox-required-error"),y(a).find("input").each(function(){y(this).attr("required",!1)})):(y(a).addClass("wc-pao-addon-checkbox-required-error"),y(a).find("input").each(function(){y(this).attr("required",!0)}))})})});
